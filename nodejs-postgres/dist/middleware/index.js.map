{"version":3,"sources":["../../src/middleware/index.js"],"names":["app","use","passport","initialize","session","opts","serializeUser","user","done","username","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","SECRET","JwtStrategy","jwtPayload","expirationDate","Date","exp","newDate"],"mappings":";;AAAA;;;;AACA;;;;AACA;;AACA;;;;AAEAA,SAAIC,GAAJ,CAAQC,mBAASC,UAAjB;AACAH,SAAIC,GAAJ,CAAQC,mBAASE,OAAjB;AACA,IAAIC,OAAO,EAAX;;AAEAH,mBAASI,aAAT,CAAuB,UAACC,IAAD,EAAMC,IAAN,EAAa;AAChCA,SAAK,IAAL,EAAUD,KAAKE,QAAf;AACH,CAFD;;AAIAJ,KAAKK,cAAL,GAAsBC,gBAAWC,2BAAX,EAAtB;AACAP,KAAKQ,WAAL,GAAmBC,MAAnB;;AAEAZ,mBAASD,GAAT,CAAa,IAAIc,kBAAJ,CAAgBV,IAAhB,EAAqB,UAASW,UAAT,EAAqBR,IAArB,EAA0B;AACxD,QAAIS,iBAAiB,IAAIC,IAAJ,CAASF,WAAWG,GAAX,GAAiB,IAA1B,CAArB;AACA,QAAGF,iBAAiBG,SAApB,EACA;AACI,eAAOZ,KAAK,IAAL,EAAU,KAAV,CAAP;AACH;AACD,QAAID,OAAOS,UAAX;AACAR,SAAK,IAAL,EAAUD,IAAV;AACH,CARY,CAAb","file":"index.js","sourcesContent":["import passport from \"passport\";\r\nimport JwtStrategy from \"passport-jwt/lib/strategy\";\r\nimport { ExtractJwt } from \"passport-jwt/lib\";\r\nimport { app } from \"../app\";\r\n\r\napp.use(passport.initialize);\r\napp.use(passport.session);\r\nvar opts = {}\r\n\r\npassport.serializeUser((user,done)=>{\r\n    done(null,user.username);\r\n})\r\n\r\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken()\r\nopts.secretOrKey = SECRET\r\n\r\npassport.use(new JwtStrategy(opts,function(jwtPayload, done){\r\n    var expirationDate = new Date(jwtPayload.exp * 1000)\r\n    if(expirationDate < newDate())\r\n    {\r\n        return done(null,false);\r\n    }\r\n    var user = jwtPayload;\r\n    done(null,user);\r\n}))"]}