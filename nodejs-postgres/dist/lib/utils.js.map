{"version":3,"sources":["../../src/lib/utils.js"],"names":["pathToKey","path","join","__dirname","replace","PRIV_KEY","fs","readFileSync","issueJWT","user","id","username","expiresIn","payload","sub","issuedDate","Date","now","signedToken","jsonwebtoken","sign","algorithm","token"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA;AACA;AACA,IAAMA,YAAYC,eAAKC,IAAL,CAAUC,UAAUC,OAAV,CAAkB,MAAlB,EAAyB,KAAzB,CAAV,EAA2C,IAA3C,EAAiD,iBAAjD,CAAlB;AACA,IAAMC,WAAWC,aAAGC,YAAH,CAAgBP,SAAhB,EAA2B,MAA3B,CAAjB;;AAEO,IAAMQ,8BAAW,SAAXA,QAAW,CAASC,IAAT,EAAc;AAClC,QAAMC,KAAKD,KAAKE,QAAhB;AACA,QAAMC,YAAY,IAAlB;;AAEA,QAAMC,UAAU;AACZC,aAAMJ,EADM;AAEZK,oBAAaC,KAAKC,GAAL;AAFD,KAAhB;AAIA;AACA,QAAMC,cAAcC,uBAAaC,IAAb,CAAkBP,OAAlB,EAA2BR,QAA3B,EAAqC,EAAEO,WAAWA,SAAb,EAAwBS,WAAW,OAAnC,EAArC,CAApB,CATkC,CASsE;AACxG,WAAO;AACHC,eAAO,YAAWJ,WADf;AAEHN,mBAAWA;AAFR,KAAP;AAKH,CAfM","file":"utils.js","sourcesContent":["import jsonwebtoken from \"jsonwebtoken\";\r\nimport path from \"path\";\r\nimport fs from \"fs\";\r\n\r\n// const pathToKey = path.join(__dirname.replace(\"dist\",\"src\"), '..', 'id_rsa_pub.pem');\r\n// const PUB_KEY = fs.readFileSync(pathToKey, 'utf8');\r\nconst pathToKey = path.join(__dirname.replace(\"dist\",\"src\"), '..', 'id_rsa_priv.pem');\r\nconst PRIV_KEY = fs.readFileSync(pathToKey, 'utf8');\r\n\r\nexport const issueJWT = function(user){\r\n    const id = user.username;\r\n    const expiresIn = '1d';\r\n\r\n    const payload = {\r\n        sub : id,\r\n        issuedDate : Date.now()\r\n    };\r\n    //console.log(\"check all\",pathToKey,\" : \",payload.sub,\" : \",payload.issuedDate,\" : \",PUB_KEY);\r\n    const signedToken = jsonwebtoken.sign(payload, PRIV_KEY, { expiresIn: expiresIn, algorithm: 'RS256' }); // { expiresIn: expiresIn, algorithm: 'RS256' } mentioning to sign using algrthm RS256\r\n    return {\r\n        token: 'bearer '+ signedToken,\r\n        expiresIn: expiresIn\r\n    }\r\n\r\n}"]}